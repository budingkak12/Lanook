概述
- 本项目已移除“用户”概念，所有标签（如 `like`、`favorite`）为全局状态。
- 目的：与前端伪代码保持一致，简化数据模型与接口。

数据表
- `media`
  - `id` INTEGER PK
  - `filename` TEXT
  - `absolute_path` TEXT UNIQUE
  - `media_type` TEXT 取值 `image` 或 `video`
  - `created_at` DATETIME

- `tag_definitions`
  - `name` TEXT PK（示例：`like`、`favorite`）

- `media_tags`
  - `id` INTEGER PK
  - `media_id` INTEGER FK -> `media.id`
  - `tag_name` TEXT FK -> `tag_definitions.name`
  - `created_at` DATETIME
  - 约束：`UNIQUE(media_id, tag_name)`（同一媒体同一种标签仅出现一次）

与前端伪代码的接口约定（建议）
- 冷启动：`GET /session` 可选（无用户与会话需求，可复用已有种子）。
- 加载流：`GET /feed?offset=<int>&limit=<int>` 返回媒体列表。可按 `created_at` 倒序分页。
- 标签列表：`GET /tag/{tag}?offset=<int>&limit=<int>` 返回被该标签标记的媒体列表。
- 添加标签：`POST /tag { media_id, tag="like" | "favorite" }`（不再需要 `user_id`）。
- 移除标签：`DELETE /tag { media_id, tag }` 或 `POST /tag/remove { media_id, tag }`。

示例 SQL 操作
- 添加“喜欢”：
  - `INSERT INTO media_tags (media_id, tag_name, created_at) VALUES (?, 'like', CURRENT_TIMESTAMP)`
- 取消“喜欢”：
  - `DELETE FROM media_tags WHERE media_id = ? AND tag_name = 'like'`
- 查询“收藏”分页：
  - `SELECT m.* FROM media m JOIN media_tags t ON t.media_id = m.id WHERE t.tag_name = 'favorite' ORDER BY t.created_at DESC LIMIT :limit OFFSET :offset`
- 推荐流分页：
  - `SELECT * FROM media ORDER BY created_at DESC LIMIT :limit OFFSET :offset`

迁移与注意事项
- 旧版数据库包含 `users`、`user_tags` 表。若此前已生成 `media_app.db`，建议删除该文件后重新运行初始化脚本以应用新的结构。
- 新结构不保存播放进度（`playbackPosition` 属于前端运行时状态），若需要持久化，可新增表 `media_progress`（`media_id`、`position_seconds`、`updated_at`）。

设计取舍
- 无用户场景下，标签采用全局集合语义，符合轻量化应用与单设备本地浏览需求。
- 如未来需要多设备或多身份同步，再引入 `users` 与 `user_media_tags` 即可平滑扩展。

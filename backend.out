/Users/wang/Documents/mytikt/.venv/lib/python3.12/site-packages/fs/__init__.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)  # type: ignore
/Users/wang/Documents/mytikt/main.py:63: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/Users/wang/Documents/mytikt/main.py:91: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/Users/wang/Documents/mytikt/main.py:111: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/Users/wang/Documents/mytikt/main.py:138: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/Users/wang/Documents/mytikt/main.py:150: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/Users/wang/Documents/mytikt/main.py:159: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("shutdown")
/Users/wang/Documents/mytikt/main.py:168: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("shutdown")
/Users/wang/Documents/mytikt/main.py:176: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [76770]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
[startup] 正在清理端口 8000...
[startup] 端口 8000 没有被占用
[startup] 端口清理完成
[boot] Media App API 即将启动: http://10.175.87.74:8000  (本机: http://localhost:8000)
[startup] 前端静态资源已托管: /Users/wang/Documents/mytikt/webclient/out
[startup] Skip DB init (set MEDIA_APP_INIT_ON_STARTUP=1 to enable).
[auto-scan] 启动失败：尚未配置媒体目录，文件索引服务暂不可用。
[startup] 资产处理流水线已启动。
[boot] Media App API 即将启动: http://10.175.87.74:8000  (本机: http://localhost:8000)
[startup] 前端自动打开: 已禁用 (修改 main.py 中的 AUTO_OPEN_BROWSER 变量)
[startup] 提示: 将 AUTO_OPEN_BROWSER 改为 True 可启用自动打开前端
INFO:     127.0.0.1:53511 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53512 - "GET /filesystem/roots HTTP/1.1" 200 OK
INFO:     127.0.0.1:53513 - "GET /filesystem/list?path=%2FUsers%2Fwang%2FDocuments%2Fmytikt%2Fsample_media HTTP/1.1" 200 OK
INFO:     127.0.0.1:53514 - "GET /filesystem/common-folders HTTP/1.1" 200 OK
INFO:     127.0.0.1:53515 - "GET /os-info?refresh=true HTTP/1.1" 200 OK
INFO:     127.0.0.1:53516 - "POST /permissions/probe HTTP/1.1" 200 OK
INFO:     127.0.0.1:53517 - "POST /network/discover HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:53518 - "POST /network/browse HTTP/1.1" 422 Unprocessable Entity
完全清除数据库完成：
  - 媒体文件: 0 条
  - 媒体标签: 0 条
  - 媒体来源: 0 条
  - 扫描任务: 0 条
  - 媒体根目录设置: 0 条
  - 自动扫描设置: 1 条
总计删除 1 条记录
INFO:     127.0.0.1:53519 - "POST /settings/reset-initialization HTTP/1.1" 200 OK
INFO:     127.0.0.1:53520 - "GET /init-status?skip_auto_restore=true HTTP/1.1" 200 OK
INFO:     127.0.0.1:53521 - "POST /setup/source/validate HTTP/1.1" 200 OK
正在填充初始数据...
  - 添加标签类型: 'like'
  - 添加标签类型: 'favorite'
  - 添加默认设置: 'auto_scan_enabled' = '1'
  - 添加默认设置: 'scan_mode' = 'realtime'
  - 添加默认设置: 'scan_interval' = 'hourly'
✅ 初始数据填充完毕。
[media-root] 首批导入 30 个媒体文件。
[auto-scan] 开始监控目录: /Users/wang/Documents/mytikt/sample_media
[auto-scan] 已启动 1 个目录实时监控任务。
INFO:     127.0.0.1:53522 - "POST /media-root HTTP/1.1" 200 OK
INFO:     127.0.0.1:53523 - "GET /media-sources?include_inactive=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:53524 - "POST /scan/start?source_id=1 HTTP/1.1" 202 Accepted
INFO:     127.0.0.1:53525 - "GET /scan/status?job_id=0abc52b2-4830-4bf5-8049-7b53fc131a10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53530 - "GET /scan/status?job_id=0abc52b2-4830-4bf5-8049-7b53fc131a10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53531 - "GET /init-status HTTP/1.1" 200 OK
INFO:     127.0.0.1:53532 - "GET /tasks/scan-progress HTTP/1.1" 200 OK
INFO:     127.0.0.1:53533 - "GET /settings/auto-scan HTTP/1.1" 200 OK
[auto-scan] 已启动 1 个目录实时监控任务。
INFO:     127.0.0.1:53534 - "POST /settings/auto-scan HTTP/1.1" 200 OK
INFO:     127.0.0.1:53535 - "POST /setup/source/validate HTTP/1.1" 200 OK
INFO:     127.0.0.1:53537 - "POST /setup/source HTTP/1.1" 201 Created
INFO:     127.0.0.1:53538 - "GET /media-sources?include_inactive=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:53539 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53540 - "GET /media-list?seed=seed-1763112621-3hfeqcj4n02ybg1s&offset=0&limit=5&order=seeded HTTP/1.1" 200 OK
INFO:     127.0.0.1:53541 - "GET /media-resource/25 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53542 - "HEAD /media-resource/25 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53543 - "GET /media-list?seed=seed-1763112621-3hfeqcj4n02ybg1s&offset=5&limit=5&order=seeded HTTP/1.1" 200 OK
INFO:     127.0.0.1:53544 - "GET /media-list?seed=seed-1763112621-3hfeqcj4n02ybg1s&offset=0&limit=3&order=recent HTTP/1.1" 200 OK
INFO:     127.0.0.1:53545 - "GET /media/25/thumbnail HTTP/1.1" 200 OK
INFO:     127.0.0.1:53546 - "GET /media-list?offset=0&limit=1 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:53547 - "GET /tags HTTP/1.1" 200 OK
INFO:     127.0.0.1:53548 - "POST /tag HTTP/1.1" 200 OK
INFO:     127.0.0.1:53549 - "POST /tag HTTP/1.1" 409 Conflict
INFO:     127.0.0.1:53550 - "GET /media-list?tag=like&offset=0&limit=5 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53551 - "DELETE /tag HTTP/1.1" 204 No Content
INFO:     127.0.0.1:53552 - "GET /media-resource/25 HTTP/1.1" 206 Partial Content
INFO:     127.0.0.1:53553 - "GET /media-resource/25 HTTP/1.1" 416 Requested Range Not Satisfiable
INFO:     127.0.0.1:53554 - "DELETE /media/25?delete_file=true HTTP/1.1" 204 No Content
INFO:     127.0.0.1:53555 - "GET /media-resource/25 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53556 - "GET /media-list?seed=seed-1763112621-3hfeqcj4n02ybg1s&offset=0&limit=6&order=seeded HTTP/1.1" 200 OK
[auto-scan] 检测到新文件: /Users/wang/Documents/mytikt/sample_media/sample1.jpg
INFO:     127.0.0.1:53557 - "POST /media/batch-delete HTTP/1.1" 200 OK
INFO:     127.0.0.1:53558 - "POST /media/batch-delete HTTP/1.1" 200 OK
INFO:     127.0.0.1:53559 - "GET /media-resource/19 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53560 - "GET /media-resource/28 HTTP/1.1" 404 Not Found
[auto-scan] 远程路径使用定期扫描: smb://testuser@10.175.87.74/PublicShare
[auto-scan] 手动触发远程路径扫描: smb://testuser@10.175.87.74/PublicShare
[auto-scan] 检测到新文件: /Users/wang/Documents/mytikt/sample_media/mp44.mp4
[auto-scan] 检测到新文件: /Users/wang/Documents/mytikt/sample_media/0022.jpg
[auto-scan] 远程路径扫描新增 28 个文件: smb://testuser@10.175.87.74/PublicShare
[auto-scan] 手动扫描新增 28 个文件: smb://testuser@10.175.87.74/PublicShare
INFO:     127.0.0.1:53561 - "DELETE /media-sources/1?hard=false HTTP/1.1" 204 No Content
INFO:     127.0.0.1:53564 - "GET /media-sources?include_inactive=true HTTP/1.1" 200 OK
[auto-scan] 手动触发远程路径扫描: smb://testuser@10.175.87.74/PublicShare
INFO:     127.0.0.1:53565 - "POST /media-sources/1/restore HTTP/1.1" 200 OK
[auto-scan] 停止监控目录: smb://testuser@10.175.87.74/PublicShare
INFO:     127.0.0.1:53567 - "DELETE /media-sources/2?hard=false HTTP/1.1" 204 No Content
INFO:     127.0.0.1:53568 - "GET /media-sources?include_inactive=true HTTP/1.1" 200 OK
[auto-scan] 远程路径使用定期扫描: smb://testuser@10.175.87.74/PublicShare
[auto-scan] 手动触发远程路径扫描: smb://testuser@10.175.87.74/PublicShare
INFO:     127.0.0.1:53569 - "POST /media-sources/2/restore HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [76770]
